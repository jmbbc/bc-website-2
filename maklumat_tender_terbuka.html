<!DOCTYPE html>
<html class="light" lang="ms">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Maklumat Tender Terbuka | Banjaria Court</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&amp;display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#347969",
                        "primary-dark": "#2a6255",
                        "accent-terracotta": "#E68A7D",
                        "background-light": "#fbfaf9",
                        "background-dark": "#213131",
                        "surface-light": "#ffffff",
                        "muted-green": "#60857d",
                        "soft-green": "#e3ebe9",
                        "text-main": "#2C3333",
                        "cream": "#FDFCF8",
                        "stone-surface": "#F5F2EB",
                        "accent-warm": "#D4A373",
                        "secondary": "#8AA899",
                        "surface-dark": "#2d3f3f"
                    },
                    fontFamily: {
                        "display": ["Manrope", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        .botanical-pattern {
            background-image: url(https://lh3.googleusercontent.com/aida-public/AB6AXuAQlV9n_lw92AvtweanPVLbiA-T9qBaeUDe9CAa6K7JCOMq0-JUjOFAySAlzTw80fBGjwsqeutlS4E5PLGgNSg-OmBZ66oS-3Gfes2Td8HRmPxqdSXLoHR01423W9c--kaMjxaMKI0p6dBVUf7PoRUuLuQQmcELlFdFhcMOiOuiLvrF_sVnzQpE6Z58FhDB-jhxTP8ojw0_pwBlOK-SrqtQvzoJEVL7ucXFwT6KOssU6RRbGZ9W8U_5bkTQ0kxpOHvEBOEjdaRgVE0);
            opacity: 0.05;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #d6e1de; border-radius: 10px; }
    </style>
</head>
<body class="bg-cream text-text-main font-display antialiased min-h-screen">
    <div class="mx-auto w-full">
        <div class="bg-primary/5 py-2 px-4 text-center border-b border-primary/10">
            <p class="text-xs md:text-sm font-medium text-primary flex items-center justify-center gap-2">
                <span class="material-symbols-outlined text-sm">spa</span>
                <span>Notis: Penjagaan taman tahunan dijalankan hujung minggu ini.</span>
            </p>
        </div>
        <header class="sticky top-0 z-50 bg-cream/90 backdrop-blur-md border-b border-stone-200/60">
            <div class="max-w-7xl mx-auto px-6 lg:px-8 py-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="bg-primary text-white p-2 rounded-xl">
                        <span class="material-symbols-outlined block">yard</span>
                    </div>
                    <div class="leading-tight">
                        <h1 class="text-xl font-bold tracking-tight text-primary">Banjaria<span class="font-light text-text-main ml-1">Court</span></h1>
                        <p class="text-[0.65rem] font-medium tracking-widest uppercase text-text-main/50">Urban Sanctuary</p>
                    </div>
                </div>
                <nav class="hidden lg:flex items-center gap-8">
                    <a class="text-text-main/70 hover:text-primary transition-colors text-sm font-medium" href="index.html">Utama</a>
                    <a class="text-text-main/70 hover:text-primary transition-colors text-sm font-medium" href="halaman_notis_kediaman.html">Notis</a>
                    <a class="text-text-main/70 hover:text-primary transition-colors text-sm font-medium" href="kemudahan_banjaria_court.html">Kemudahan</a>
                    <a class="text-text-main/70 hover:text-primary transition-colors text-sm font-medium" href="aktiviti_komuniti_banjaria.html">Komuniti</a>
                    <a class="text-text-main/70 hover:text-primary transition-colors text-sm font-medium" href="laporan_agm_dan_egm.html">Laporan</a>
                    <a class="text-primary font-bold text-sm relative after:content-[''] after:absolute after:-bottom-2 after:left-0 after:w-full after:h-0.5 after:bg-primary after:rounded-full" href="maklumat_tender_terbuka.html">Tender</a>
                    <a class="text-text-main/70 hover:text-primary transition-colors text-sm font-medium" href="senarai_vendor_berdaftar.html">Vendor</a>
                </nav>
                <div class="flex items-center gap-4">
                    <a class="hidden md:flex bg-white border border-stone-200 text-primary px-5 py-2.5 rounded-full text-sm font-bold hover:shadow-soft hover:-translate-y-0.5 transition-all items-center gap-2" href="admin.html">
                        <span class="material-symbols-outlined text-lg">admin_panel_settings</span>
                        Admin Log Masuk
                    </a>
                    <button id="mobileMenuBtn" class="lg:hidden text-text-main p-1" aria-label="Toggle menu">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                </div>
            </div>
        </header>

        <div id="mobileNav" class="lg:hidden hidden bg-white border-b border-stone-200 shadow-sm">
            <div class="max-w-7xl mx-auto px-6 py-3 flex flex-col gap-3 text-sm font-semibold text-text-main">
                <a class="hover:text-primary" href="index.html">Utama</a>
                <a class="hover:text-primary" href="halaman_notis_kediaman.html">Notis</a>
                <a class="hover:text-primary" href="kemudahan_banjaria_court.html">Kemudahan</a>
                <a class="hover:text-primary" href="aktiviti_komuniti_banjaria.html">Komuniti</a>
                <a class="hover:text-primary" href="laporan_agm_dan_egm.html">Laporan</a>
                <a class="text-primary" href="maklumat_tender_terbuka.html">Tender</a>
                <a class="hover:text-primary" href="senarai_vendor_berdaftar.html">Vendor</a>
            </div>
        </div>

<div class="w-full border-b border-light-oak/20 relative overflow-hidden" style="background: linear-gradient(120deg, rgba(244,244,241,0.9), rgba(244,244,241,0.7)), url('/assets/organised-documents-references.jpg') center/cover no-repeat;">
  <div class="absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-white/40 to-transparent pointer-events-none"></div>

  <div class="max-w-[1000px] mx-auto relative z-10 text-center px-8 lg:px-12 py-12 lg:py-16">
    <div class="inline-flex items-center gap-2 px-4 py-1.5 bg-white dark:bg-white/10 rounded-full border border-light-oak/40 shadow-sm mb-6">
      <span class="size-2 rounded-full" style="background:#6BA08E"></span>
      <span class="text-xs font-bold text-primary dark:text-white uppercase tracking-wider">Pusat Perolehan</span>
    </div>
    <h1 class="text-4xl lg:text-5xl font-extrabold leading-tight tracking-tight text-[#1c2120] dark:text-white mb-6">Maklumat Tender Terbuka</h1>
    <p class="max-w-2xl mx-auto text-[#60857d] dark:text-[#a0bcba] text-lg md:text-xl font-medium leading-relaxed mt-4">Ketelusan dalam setiap langkah. Kami memastikan standard kualiti tertinggi untuk komuniti Banjaria Court yang harmoni.</p>
    <div class="flex flex-wrap justify-center gap-4 pt-2">
      <a class="flex h-12 items-center justify-center rounded-xl bg-white px-8 text-primary text-sm font-bold shadow-lg transition-all hover:bg-opacity-90 hover:scale-105" href="portal_borang_digital.html">Garis Panduan</a>
      <a class="flex h-12 items-center justify-center rounded-xl bg-primary px-8 text-white text-sm font-bold shadow-lg transition-all hover:bg-opacity-90 hover:scale-105" href="hubungi_pengurusan_banjaria.html">Hubungi Pengurusan</a>
    </div>
  </div>
</div>
<main class="max-w-[1200px] mx-auto px-6 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16">
            <div class="bg-surface-light dark:bg-[#2d3f3b] p-8 rounded-[2rem] border border-[#eaf0ef] dark:border-[#3a504b] shadow-[0_4px_20px_-10px_rgba(0,0,0,0.05)] flex items-center gap-6 group hover:border-primary/30 transition-all hover:shadow-lg hover:shadow-primary/5">
                <div class="size-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary group-hover:scale-110 transition-transform">
                    <span class="material-symbols-outlined text-3xl">assignment_turned_in</span>
                </div>
                <div>
                    <p class="text-muted-green dark:text-gray-400 text-xs font-bold uppercase tracking-widest mb-1">Tender Aktif</p>
                    <p id="tenderActiveCount" class="text-4xl font-black text-primary-dark dark:text-white">05</p>
                </div>
            </div>
            <div class="bg-surface-light dark:bg-[#2d3f3b] p-8 rounded-[2rem] border border-[#eaf0ef] dark:border-[#3a504b] shadow-[0_4px_20px_-10px_rgba(0,0,0,0.05)] flex items-center gap-6 group hover:border-accent-terracotta/30 transition-all hover:shadow-lg hover:shadow-accent-terracotta/5">
                <div class="size-16 rounded-2xl bg-accent-terracotta/10 flex items-center justify-center text-accent-terracotta group-hover:scale-110 transition-transform">
                    <span class="material-symbols-outlined text-3xl">hourglass_top</span>
                </div>
                <div>
                    <p class="text-muted-green dark:text-gray-400 text-xs font-bold uppercase tracking-widest mb-1">Tamat Segera</p>
                    <p id="tenderClosingCount" class="text-4xl font-black text-primary-dark dark:text-white">02</p>
                </div>
            </div>
            <div class="bg-surface-light dark:bg-[#2d3f3b] p-8 rounded-[2rem] border border-[#eaf0ef] dark:border-[#3a504b] shadow-[0_4px_20px_-10px_rgba(0,0,0,0.05)] flex items-center gap-6 group hover:border-primary/30 transition-all hover:shadow-lg hover:shadow-primary/5">
                <div class="size-16 rounded-2xl bg-primary/10 flex items-center justify-center text-primary group-hover:scale-110 transition-transform">
                    <span class="material-symbols-outlined text-3xl">inventory_2</span>
                </div>
                <div>
                    <p class="text-muted-green dark:text-gray-400 text-xs font-bold uppercase tracking-widest mb-1">Arkib Tender</p>
                    <p id="tenderArchiveCount" class="text-4xl font-black text-primary-dark dark:text-white">12</p>
                </div>
            </div>
        </div>

        <section class="bg-surface-light dark:bg-[#2d3f3b] rounded-[2rem] border border-[#eaf0ef] dark:border-[#3a504b] shadow-sm overflow-hidden mb-12">
            <div class="px-8 pt-10 pb-6 border-b border-[#eaf0ef] dark:border-[#3a504b]">
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-8">
                    <div>
                        <h2 class="text-3xl font-black tracking-tight text-primary-dark dark:text-white mb-2">Senarai Tender</h2>
                        <p class="text-muted-green dark:text-gray-400 text-sm font-medium">Lihat senarai tender semasa dan perincian projek.</p>
                    </div>
                    <div class="flex flex-wrap gap-3">
                        <div class="relative">
                            <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-muted-green text-lg">search</span>
                            <input id="tenderSearchInput" class="pl-10 pr-4 py-2.5 bg-background-light dark:bg-[#1f2d2b] border border-[#eaf0ef] dark:border-[#3a504b] rounded-xl text-sm font-semibold focus:ring-2 focus:ring-primary/20 focus:border-primary w-64 transition-all" placeholder="Cari ID atau tajuk..." type="text" />
                        </div>
                        <div class="flex bg-[#eaf0ef] dark:bg-[#1a2624] p-1 rounded-xl" id="tenderStatusFilters">
                            <button data-status="all" class="px-5 py-2 rounded-lg text-xs font-bold bg-white dark:bg-primary text-primary dark:text-white shadow-sm transition-all uppercase tracking-wide">Semua</button>
                            <button data-status="open" class="px-5 py-2 rounded-lg text-xs font-bold text-muted-green hover:text-primary transition-colors uppercase tracking-wide">Buka</button>
                            <button data-status="closed" class="px-5 py-2 rounded-lg text-xs font-bold text-muted-green hover:text-primary transition-colors uppercase tracking-wide">Tutup</button>
                        </div>
                    </div>
                </div>
                <div class="flex flex-wrap gap-3">
                    <button data-category="all" class="flex items-center gap-2 px-5 py-2.5 bg-primary text-white rounded-full text-xs font-bold shadow-lg shadow-primary/20 hover:bg-primary-dark transition-colors">
                        <span class="material-symbols-outlined text-sm">tune</span>
                        Semua Kategori
                    </button>
                    <button data-category="Penyelenggaraan" class="flex items-center gap-2 px-5 py-2.5 bg-background-light dark:bg-[#1f2d2b] text-muted-green hover:text-primary border border-transparent hover:border-primary/20 rounded-full text-xs font-bold transition-all">Penyelenggaraan</button>
                    <button data-category="Keselamatan" class="flex items-center gap-2 px-5 py-2.5 bg-background-light dark:bg-[#1f2d2b] text-muted-green hover:text-primary border border-transparent hover:border-primary/20 rounded-full text-xs font-bold transition-all">Keselamatan</button>
                    <button data-category="Naik Taraf" class="flex items-center gap-2 px-5 py-2.5 bg-background-light dark:bg-[#1f2d2b] text-muted-green hover:text-primary border border-transparent hover:border-primary/20 rounded-full text-xs font-bold transition-all">Naik Taraf</button>
                    <button data-category="Landskap" class="flex items-center gap-2 px-5 py-2.5 bg-background-light dark:bg-[#1f2d2b] text-muted-green hover:text-primary border border-transparent hover:border-primary/20 rounded-full text-xs font-bold transition-all">Landskap</button>
                </div>
            </div>

            <div class="overflow-x-auto custom-scrollbar">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-soft-green/50 dark:bg-[#1f2d2b] border-b border-[#eaf0ef] dark:border-[#3a504b]">
                            <th class="px-8 py-6 text-xs font-extrabold uppercase tracking-widest text-primary-dark/70 dark:text-muted-green">Tajuk Projek</th>
                            <th class="px-6 py-6 text-xs font-extrabold uppercase tracking-widest text-primary-dark/70 dark:text-muted-green">Kategori</th>
                            <th class="px-6 py-6 text-xs font-extrabold uppercase tracking-widest text-primary-dark/70 dark:text-muted-green">Tarikh Tutup</th>
                            <th class="px-6 py-6 text-xs font-extrabold uppercase tracking-widest text-primary-dark/70 dark:text-muted-green">Status</th>
                            <th class="px-8 py-6 text-xs font-extrabold uppercase tracking-widest text-primary-dark/70 dark:text-muted-green text-right">Tindakan</th>
                        </tr>
                    </thead>
                    <tbody id="tenderTableBody" class="divide-y divide-[#eaf0ef] dark:divide-[#3a504b] bg-white dark:bg-[#2d3f3b]"></tbody>
                </table>
            </div>

            <div class="px-8 py-6 bg-white dark:bg-[#1f2d2b] flex flex-col md:flex-row items-center justify-between border-t border-[#eaf0ef] dark:border-[#3a504b] gap-4">
                <p class="text-xs text-muted-green font-medium italic">Nota: Semua dokumen tender adalah sulit dan tertakluk kepada akta kerahsiaan.</p>
                <div class="flex items-center gap-3">
                    <span id="tenderCount" class="text-xs text-muted-green">Menunjukkan 0 tender</span>
                    <button id="tenderLoadMore" class="hidden bg-white dark:bg-[#1a2624] border border-[#eaf0ef] dark:border-[#3a504b] text-primary px-4 py-2 rounded-xl text-xs font-bold hover:bg-primary hover:text-white transition-all flex items-center gap-2">
                        <span class="material-symbols-outlined text-sm">unfold_more</span>
                        Muatkan Lagi
                    </button>
                </div>
            </div>
        </section>

        <div class="mt-8 mb-16 p-10 bg-gradient-to-br from-primary/5 to-white dark:from-primary/10 dark:to-[#213131] rounded-[2.5rem] border border-primary/10 flex flex-col md:flex-row items-center justify-between gap-8 shadow-sm">
            <div class="flex items-center gap-8">
                <div class="size-20 rounded-full bg-white dark:bg-primary flex items-center justify-center text-primary dark:text-white shadow-lg shadow-primary/10 shrink-0">
                    <span class="material-symbols-outlined text-4xl">support_agent</span>
                </div>
                <div>
                    <h4 class="text-2xl font-black text-primary-dark dark:text-white mb-2">Perlukan Bantuan?</h4>
                    <p class="text-muted-green dark:text-gray-400 text-base max-w-md">Pasukan kami sedia membantu menjawab sebarang pertanyaan mengenai proses tender dan dokumentasi.</p>
                </div>
            </div>
            <a class="bg-primary hover:bg-primary-dark text-white px-8 py-4 rounded-2xl font-bold text-sm hover:scale-105 transition-all shadow-xl shadow-primary/20 flex items-center gap-3 shrink-0" href="hubungi_pengurusan_banjaria.html">
                <span class="material-symbols-outlined">call</span>
                Hubungi Talian Khas
            </a>
        </div>
    </main>

    <footer class="bg-white border-t border-stone-200 pt-16 pb-10 px-4 lg:px-8">
        <div class="max-w-7xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-16">
                <div class="col-span-1">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="bg-stone-100 p-2 rounded-lg text-primary">
                            <span class="material-symbols-outlined block">yard</span>
                        </div>
                        <h1 class="text-lg font-bold tracking-tight text-text-main">Banjaria Court</h1>
                    </div>
                    <p class="text-text-main/60 text-sm leading-relaxed mb-6 font-light">Komuniti kediaman premium yang menitikberatkan ketenangan, keselamatan, dan gaya hidup moden.</p>
                    <div class="flex gap-3">
                        <a class="w-9 h-9 rounded-full bg-stone-50 border border-stone-100 flex items-center justify-center text-primary hover:bg-primary hover:text-white transition-all" href="#"><span class="material-symbols-outlined text-lg">share</span></a>
                        <a class="w-9 h-9 rounded-full bg-stone-50 border border-stone-100 flex items-center justify-center text-primary hover:bg-primary hover:text-white transition-all" href="#"><span class="material-symbols-outlined text-lg">mail</span></a>
                    </div>
                </div>
                <div>
                    <h4 class="font-bold text-base mb-6 text-text-main">Akses Pantas</h4>
                    <ul class="space-y-3 text-sm text-text-main/60">
                        <li><a class="hover:text-primary transition-colors" href="index.html">Laman Utama</a></li>
                        <li><a class="hover:text-primary transition-colors" href="halaman_notis_kediaman.html">Papan Notis</a></li>
                        <li><a class="hover:text-primary transition-colors" href="kemudahan_banjaria_court.html">Tempahan Kemudahan</a></li>
                        <li><a class="hover:text-primary transition-colors" href="portal_borang_digital.html">Portal Penduduk</a></li>
                        <li><a class="hover:text-primary transition-colors" href="laporan_agm_dan_egm.html">Laporan AGM/EGM</a></li>
                        <li><a class="hover:text-primary transition-colors" href="maklumat_tender_terbuka.html">Tender Terbuka</a></li>
                        <li><a class="hover:text-primary transition-colors" href="senarai_vendor_berdaftar.html">Vendor Berdaftar</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-base mb-6 text-text-main">Sumber</h4>
                    <ul class="space-y-3 text-sm text-text-main/60">
                        <li><a class="hover:text-primary transition-colors" href="portal_borang_digital.html">Peraturan Rumah</a></li>
                        <li><a class="hover:text-primary transition-colors" href="portal_borang_digital.html">Garis Panduan Renovasi</a></li>
                        <li><a class="hover:text-primary transition-colors" href="portal_borang_digital.html">Pengurusan Pelawat</a></li>
                        <li><a class="hover:text-primary transition-colors" href="portal_borang_digital.html">Borang &amp; Muat Turun</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-base mb-6 text-text-main">Hubungi</h4>
                    <div class="space-y-3 text-sm text-text-main/60">
                        <p class="flex items-start gap-3"><span class="material-symbols-outlined text-primary text-base mt-0.5">location_on</span><span>Aras G, Bangunan Kelab,<br/>Banjaria Court, 68100 Batu Caves</span></p>
                        <p class="flex items-center gap-3"><span class="material-symbols-outlined text-primary text-base">call</span>+60 3-1234 5678</p>
                    </div>
                </div>
            </div>
            <div class="border-t border-stone-100 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-xs text-text-main/40">Â© 2024 Pengurusan Banjaria Court. Hak cipta terpelihara.</p>
                <div class="flex gap-6 text-xs text-text-main/40 font-medium">
                    <a class="hover:text-primary transition-colors" href="#">Privasi</a>
                    <a class="hover:text-primary transition-colors" href="#">Terma</a>
                    <a class="hover:text-primary transition-colors" href="#">Peta Laman</a>
                </div>
            </div>
        </div>
    </footer>
    </div>
<script>
    (() => {
        const storageKey = 'pageDataV1';
        const pageKey = 'tender';
        const tableBody = document.getElementById('tenderTableBody');
        const searchInput = document.getElementById('tenderSearchInput');
        const statusButtons = document.querySelectorAll('#tenderStatusFilters [data-status]');
        const categoryButtons = document.querySelectorAll('[data-category]');
        const activeEl = document.getElementById('tenderActiveCount');
        const closingEl = document.getElementById('tenderClosingCount');
        const archiveEl = document.getElementById('tenderArchiveCount');
        const loadMoreBtn = document.getElementById('tenderLoadMore');
        const tenderCountEl = document.getElementById('tenderCount');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileNav = document.getElementById('mobileNav');

        const defaultCards = [
            { tag: 'Penyelenggaraan', title: 'Pengecatan Semula Blok A & Blok B', date: '2025-01-15', summary: 'Kerja cat luar dan dalaman blok A & B, termasuk pemeriksaan retakan.', meta: 'TDR-2025-001', link: 'https://example.com/tender-2025-001.pdf' },
            { tag: 'Naik Taraf', title: 'Naiktaraf Sistem Lif (Fasa 2)', date: '2024-12-30', summary: 'Penggantian komponen kritikal lif dan sistem kecemasan.', meta: 'TDR-2024-017', link: 'https://example.com/tender-2024-017.pdf' },
            { tag: 'Keselamatan', title: 'Perkhidmatan Kawalan Keselamatan 2024', date: '2024-10-20', summary: 'Kontrak pengawal 24/7 dan rondaan parkir bertingkat.', meta: 'TDR-2024-010', link: 'https://example.com/tender-2024-010.pdf' },
            { tag: 'Landskap', title: 'Landskap & Penanaman Semula Pokok', date: '2024-11-22', summary: 'Penanaman semula pokok teduhan dan pembaikan sistem pengairan.', meta: 'TDR-2024-021', link: 'https://example.com/tender-2024-021.pdf' },
            { tag: 'Penyelenggaraan', title: 'Penggantian Paip Utama Blok C', date: '2024-11-05', summary: 'Penggantian paip utama air domestik dan ujian tekanan.', meta: 'TDR-2024-013', link: 'https://example.com/tender-2024-013.pdf' },
        ];

        function loadPageData() {
            let parsed;
            try {
                parsed = JSON.parse(localStorage.getItem(storageKey) || '{}');
            } catch (_) {
                parsed = {};
            }

            if (!parsed[pageKey] || !Array.isArray(parsed[pageKey].cards)) {
                parsed[pageKey] = { title: 'Tender Terbuka', subtitle: '', cards: defaultCards.map(c => ({ ...c, id: crypto.randomUUID() })) };
            } else {
                parsed[pageKey].cards = (parsed[pageKey].cards || []).map(c => ({ id: c.id || crypto.randomUUID(), ...c }));
            }
            localStorage.setItem(storageKey, JSON.stringify(parsed));
            return parsed;
        }

        const pageData = loadPageData();
        let currentStatus = 'all';
        let currentCategory = 'all';
        let currentSearch = '';
        const pageSize = 5;
        let visibleCount = pageSize;

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const d = new Date(dateStr);
            if (isNaN(d.getTime())) return '';
            return d.toLocaleDateString('ms-MY', { day: 'numeric', month: 'short', year: 'numeric' });
        }

        function statusInfo(dateStr) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const d = new Date(dateStr || '');
            if (!dateStr || isNaN(d.getTime())) return { status: 'unknown', badge: 'T/A', days: null };
            const diffDays = Math.ceil((d - today) / (1000 * 60 * 60 * 24));
            if (diffDays < 0) return { status: 'closed', badge: 'Ditutup', days: diffDays };
            return { status: 'open', badge: `${diffDays} Hari Lagi`, days: diffDays };
        }

        function iconForCategory(cat) {
            const map = {
                Penyelenggaraan: 'build',
                Keselamatan: 'security',
                'Naik Taraf': 'upgrade',
                Landskap: 'yard',
            };
            return map[cat] || 'description';
        }

        function updateCounters(cards) {
            const totals = cards.reduce((acc, card) => {
                const info = statusInfo(card.date);
                if (info.status === 'open') acc.active += 1;
                if (info.status === 'closed') acc.archive += 1;
                if (info.status === 'open' && info.days !== null && info.days <= 14) acc.closing += 1;
                return acc;
            }, { active: 0, closing: 0, archive: 0 });

            if (activeEl) activeEl.textContent = String(totals.active).padStart(2, '0');
            if (closingEl) closingEl.textContent = String(totals.closing).padStart(2, '0');
            if (archiveEl) archiveEl.textContent = String(totals.archive).padStart(2, '0');
        }

        function render() {
            const filtered = ((pageData[pageKey] && pageData[pageKey].cards) || []).filter(card => {
                const info = statusInfo(card.date);
                const matchesStatus = currentStatus === 'all' ? true : info.status === currentStatus;
                const matchesCategory = currentCategory === 'all' ? true : (card.tag || '').toLowerCase() === currentCategory.toLowerCase();
                const search = currentSearch.trim().toLowerCase();
                const matchesSearch = !search || (card.title || '').toLowerCase().includes(search) || (card.meta || '').toLowerCase().includes(search);
                return matchesStatus && matchesCategory && matchesSearch;
            }).sort((a, b) => new Date(a.date || 0) - new Date(b.date || 0));

            updateCounters((pageData[pageKey] && pageData[pageKey].cards) || []);

            const visible = filtered.slice(0, visibleCount);
            tableBody.innerHTML = '';
            if (!visible.length) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = '<td colspan="5" class="px-6 py-6 text-center text-muted-green">Tiada tender ditemui.</td>';
                tableBody.appendChild(emptyRow);
            } else {
                visible.forEach(card => {
                const info = statusInfo(card.date);
                const dateLabel = formatDate(card.date);
                const icon = iconForCategory(card.tag);
                const code = card.meta || 'ID Tidak Ditentukan';
                const link = card.link || card.url || '#';
                const hasLink = link && link !== '#';
                const statusBadge = info.status === 'open'
                    ? `<span class="inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 rounded-full text-xs font-bold border border-emerald-100 dark:border-emerald-800"><span class="relative flex h-2 w-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span></span>${info.badge}</span>`
                    : `<span class="inline-flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 rounded-full text-xs font-bold border border-gray-200 dark:border-gray-700"><span class="h-2 w-2 rounded-full bg-gray-400"></span>${info.badge}</span>`;

                const row = document.createElement('tr');
                row.className = 'hover:bg-[#fbfaf9] dark:hover:bg-[#253634] transition-colors group';
                row.innerHTML = `
                    <td class="px-8 py-6">
                        <div class="flex flex-col gap-1">
                            <div class="flex items-center gap-2">
                                <span class="px-2 py-0.5 rounded-md bg-primary/10 text-primary text-[10px] font-black uppercase tracking-wider">${code}</span>
                            </div>
                            <span class="font-bold text-lg text-[#111816] dark:text-white group-hover:text-primary transition-colors">${card.title || ''}</span>
                        </div>
                    </td>
                    <td class="px-6 py-6">
                        <span class="inline-flex items-center gap-2 px-3 py-1 bg-gray-100 dark:bg-gray-800 rounded-lg text-xs font-bold text-gray-600 dark:text-gray-300">
                            <span class="material-symbols-outlined text-sm">${icon}</span>
                            ${card.tag || 'Kategori'}
                        </span>
                    </td>
                    <td class="px-6 py-6">
                        <div class="flex flex-col">
                            <span class="text-sm font-bold text-gray-900 dark:text-gray-100">${dateLabel || 'Tarikh N/A'}</span>
                            <span class="text-[10px] text-accent-terracotta font-bold uppercase tracking-wide">${info.badge}</span>
                        </div>
                    </td>
                    <td class="px-6 py-6">${statusBadge}</td>
                    <td class="px-8 py-6 text-right">
                        <a ${hasLink ? `href="${link}" target="_blank" rel="noopener"` : ''} class="group/btn relative px-4 py-2 rounded-xl bg-white dark:bg-[#1a2624] border border-[#eaf0ef] dark:border-[#3a504b] text-muted-green hover:text-primary hover:border-primary transition-all inline-flex items-center gap-2 font-bold text-xs shadow-sm hover:shadow-md ${hasLink ? '' : 'opacity-50 pointer-events-none'}">
                            <span class="material-symbols-outlined text-lg">download</span>
                            Muat Turun PDF
                        </a>
                    </td>
                `;
                tableBody.appendChild(row);
                });
            }

            if (tenderCountEl) {
                tenderCountEl.textContent = `Menunjukkan ${visible.length} daripada ${filtered.length} tender`;
            }

            if (loadMoreBtn) {
                const hasMore = filtered.length > visible.length;
                loadMoreBtn.classList.toggle('hidden', !hasMore);
                loadMoreBtn.disabled = !hasMore;
            }
        }

        statusButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                statusButtons.forEach(b => b.classList.remove('bg-white', 'dark:bg-primary', 'text-primary', 'dark:text-white', 'shadow-sm'));
                statusButtons.forEach(b => b.classList.add('text-muted-green'));
                btn.classList.add('bg-white', 'dark:bg-primary', 'text-primary', 'dark:text-white', 'shadow-sm');
                btn.classList.remove('text-muted-green');
                currentStatus = btn.getAttribute('data-status') || 'all';
                visibleCount = pageSize;
                render();
            });
        });

        categoryButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                categoryButtons.forEach(b => b.classList.remove('bg-primary', 'text-white', 'shadow-lg', 'shadow-primary/20'));
                categoryButtons.forEach(b => b.classList.add('bg-background-light', 'dark:bg-[#1f2d2b]', 'text-muted-green'));
                btn.classList.add('bg-primary', 'text-white', 'shadow-lg', 'shadow-primary/20');
                btn.classList.remove('bg-background-light', 'dark:bg-[#1f2d2b]', 'text-muted-green');
                currentCategory = btn.getAttribute('data-category') || 'all';
                visibleCount = pageSize;
                render();
            });
        });

        if (searchInput) {
            searchInput.addEventListener('input', (e) => {
                currentSearch = e.target.value || '';
                visibleCount = pageSize;
                render();
            });
        }

        if (loadMoreBtn) {
            loadMoreBtn.addEventListener('click', () => {
                visibleCount += pageSize;
                render();
            });
        }

        function toggleMobileNav() {
            if (!mobileNav) return;
            mobileNav.classList.toggle('hidden');
        }

        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', toggleMobileNav);
        }

        render();
    })();
</script>
</body>
</html>
